import{M as z,N as R,O as P,P as K,Q,R as X,S as B,U as j,V as H,W as V,X as Y,B as Z,p as G,Y as $,Z as J,e as A,L as x,n as ee,b as te,s as ne,a0 as re,a1 as oe,f as se}from"./B7Bdb3zK.js";import{i as F,a as T,p as C,b as ae,k as I,f as ue,h as ce,t as ie,g as pe}from"./BVfwVV_A.js";import{u as le}from"./C04t4gW_.js";import"./CytyAsPR.js";import"./DuAV58dt.js";function fe(e,n){return n.reduce((t,o)=>{const r=de(e,o);return r!==void 0&&(t[o]=r),t},{})}function de(e,n){return n.split(".").reduce((t,o)=>t&&t[o],e)}const S="default",M=/^@|^v-on:/,N=/^:|^v-bind:/,me=/^v-model/,ge=["select","textarea","input"],ve=["math","svg"],_e=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(e=>[e,`prose-${e}`])),ye=["script","base"],he=z({name:"MDCRenderer",props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},class:{type:[String,Object],default:void 0},tag:{type:[String,Boolean],default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})},unwrap:{type:[Boolean,String],default:!1}},async setup(e){const t=X()?.appContext?.app?.$nuxt,o=t?.$route||t?._route,{mdc:r}=t?.$config?.public||{},a=P(()=>({...r?.components?.prose&&e.prose!==!1?_e:{},...r?.components?.map||{},...H(e.data?.mdc?.components||{}),...e.components})),p=P(()=>{const u=(e.body?.children||[]).map(c=>c.tag||c.type).filter(c=>!T.includes(c));return Array.from(new Set(u)).sort().join(".")}),i=K({...e.data});Q(()=>e.data,u=>{Object.assign(i,u)}),await we(e.body,{tags:a.value});function l(u,c){const d=u.split(".").length-1;return u.split(".").reduce((g,v,b)=>b==d&&g?(g[v]=c,g[v]):typeof g=="object"?g[v]:void 0,i)}return{tags:a,contentKey:p,route:o,runtimeData:i,updateRuntimeData:l}},render(e){const{tags:n,tag:t,body:o,data:r,contentKey:a,route:p,unwrap:i,runtimeData:l,updateRuntimeData:u}=e;if(!o)return null;const c={...r,tags:n,$route:p,runtimeData:l,updateRuntimeData:u},d=t!==!1?w(t||c.component?.name||c.component||"div"):void 0;return d?R(d,{...c.component?.props,class:e.class,...this.$attrs,key:a},{default:g}):g?.();function g(){const v=E(o,R,{documentMeta:c,parentScope:c,resolveComponent:w});return v?.default?i?F(v.default(),typeof i=="string"?i.split(" "):["*"]):v.default():null}}});function Pe(e,n,t,o){const{documentMeta:r,parentScope:a,resolveComponent:p}=t;if(e.type==="text")return n(V,e.value);if(e.type==="comment")return n(Y,null,e.value);const i=e.tag,l=q(e,r.tags);if(e.tag==="binding")return be(e,n,r,a);const u=L(l)?g=>g:p;if(ye.includes(l))return n("pre",{class:"mdc-renderer-dangerous-tag"},"<"+l+">"+ae(e)+"</"+l+">");const c=u(l);typeof c=="object"&&(c.tag=i);const d=Ce(e,r);return o&&(d.key=o),n(c,d,E(e,n,{documentMeta:r,parentScope:{...a,...d},resolveComponent:u}))}function E(e,n,t){const{documentMeta:o,parentScope:r,resolveComponent:a}=t,i=(e.children||[]).reduce((u,c)=>{if(!je(c))return u[S].children.push(c),u;const d=Oe(c);return u[d]=u[d]||{props:{},children:[]},c.type==="element"&&(u[d].props=c.props,u[d].children.push(...c.children||[])),u},{[S]:{props:{},children:[]}});return Object.entries(i).reduce((u,[c,{props:d,children:g}])=>(g.length&&(u[c]=(v={})=>{const b=fe(v,Object.keys(d||{}));let D=g.map((s,f)=>Pe(s,n,{documentMeta:o,parentScope:{...r,...b},resolveComponent:a},String(s.props?.key||f)));return d?.unwrap&&(D=F(D,d.unwrap)),Se(D)}),u),{})}function be(e,n,t,o={}){const r={...t.runtimeData,...o,$document:t,$doc:t},a=/\.|\[(\d+)\]/,i=(e.props?.value.trim().split(a).filter(Boolean)).reduce((u,c)=>{if(u&&c in u)return typeof u[c]=="function"?u[c]():u[c]},r),l=e.props?.defaultValue;return n(V,i??l??"")}function Ce(e,n){const{tag:t="",props:o={}}=e;return Object.keys(o).reduce(function(r,a){if(a==="__ignoreMap")return r;const p=o[a];if(me.test(a))return De(a,p,r,n,{native:ge.includes(t)});if(a==="v-bind")return Te(a,p,r,n);if(M.test(a))return Ve(a,p,r,n);if(N.test(a))return xe(a,p,r,n);const{attribute:i}=ue(ce,a);return Array.isArray(p)&&p.every(l=>typeof l=="string")?(r[i]=p.join(" "),r):(r[i]=p,r)},{})}function De(e,n,t,o,{native:r}){const a=e.match(/^v-model:([^=]+)/)?.[1]||"modelValue",p=r?"value":a,i=r?"onInput":`onUpdate:${a}`;return t[p]=O(n,o.runtimeData),t[i]=l=>{o.updateRuntimeData(n,r?l.target?.value:l)},t}function Te(e,n,t,o){const r=O(n,o);return t=Object.assign(t,r),t}function Ve(e,n,t,o){return e=e.replace(M,""),t.on=t.on||{},t.on[e]=()=>O(n,o),t}function xe(e,n,t,o){return e=e.replace(N,""),t[e]=O(n,o),t}const w=e=>{if(typeof e=="string"){if(T.includes(e))return e;const n=B(C(e),!1);return!e||n?.name==="AsyncComponentWrapper"||typeof n=="string"?n:"setup"in n?j(()=>new Promise(t=>t(n))):n}return e};function O(e,n){const t=e.split(".").reduce((o,r)=>typeof o=="object"?o[r]:void 0,n);return typeof t>"u"?Z(e):t}function Oe(e){let n="";for(const t of Object.keys(e.props||{}))if(!(!t.startsWith("#")&&!t.startsWith("v-slot:"))){n=t.split(/[:#]/,2)[1];break}return n||S}function je(e){return e.tag==="template"}function L(e){return ve.includes(e)}function Se(e){const n=[];for(const t of e){const o=n[n.length-1];t.type===V&&o?.type===V?o.children=o.children+t.children:n.push(t)}return n}async function we(e,n){if(!e)return;const t=Array.from(new Set(o(e,n)));await Promise.all(t.map(async r=>{if(r?.render||r?.ssrRender||r?.__ssrInlineRender)return;const a=w(r);a?.__asyncLoader&&!a.__asyncResolved&&await a.__asyncLoader()}));function o(r,a){const p=r.tag;if(r.type==="text"||p==="binding"||r.type==="comment")return[];const i=q(r,a.tags);if(L(i))return[];const l=[];r.type!=="root"&&!T.includes(i)&&l.push(i);for(const u of r.children||[])l.push(...o(u,a));return l}}function q(e,n){const t=e.tag;return!t||typeof e.props?.__ignoreMap<"u"?t:n[t]||n[C(t)]||n[I(e.tag)]||t}const Re=Object.assign(he,{__name:"MDCRenderer"}),U=["ProseADVue","ProseA","ProseBlockquoteDVue","ProseBlockquote","ProseCodeDVue","ProseCode","ProseEmDVue","ProseEm","ProseH1DVue","ProseH1","ProseH2DVue","ProseH2","ProseH3DVue","ProseH3","ProseH4DVue","ProseH4","ProseH5DVue","ProseH5","ProseH6DVue","ProseH6","ProseHrDVue","ProseHr","ProseImgDVue","ProseImg","ProseLiDVue","ProseLi","ProseOlDVue","ProseOl","ProsePDVue","ProseP","ProsePreDVue","ProsePre","ProseScriptDVue","ProseScript","ProseStrongDVue","ProseStrong","ProseTableDVue","ProseTable","ProseTbodyDVue","ProseTbody","ProseTdDVue","ProseTd","ProseThDVue","ProseTh","ProseTheadDVue","ProseThead","ProseTrDVue","ProseTr","ProseUlDVue","ProseUl","Icon"],W=[],Be=Object.freeze(Object.defineProperty({__proto__:null,globalComponents:U,localComponents:W},Symbol.toStringTag,{value:"Module"})),He={__name:"ContentRenderer",props:{value:{type:Object,required:!0},excerpt:{type:Boolean,default:!1},tag:{type:String,default:"div"},components:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})},prose:{type:Boolean,default:void 0},class:{type:[String,Object],default:void 0},unwrap:{type:[Boolean,String],default:!1}},setup(e){const n=["render","ssrRender","__ssrInlineRender"],t=e,o=!0,r=P(()=>{let s=t.value.body||t.value;return t.excerpt&&t.value.excerpt&&(s=t.value.excerpt),s.type==="minimal"||s.type==="minimark"?ie({value:s.value}):s}),a=P(()=>!r.value?.children?.length),p=P(()=>{const{body:s,excerpt:f,...m}=t.value;return{...m,...t.data}}),i=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(s=>[s,`prose-${s}`])),{mdc:l}=G().public||{},u=P(()=>t.data.mdc),c=P(()=>({...l?.components?.prose&&t.prose!==!1?i:{},...l?.components?.map||{},...H(u.value?.components||{}),...t.components})),d=P(()=>r.value?v(r.value,{tags:c.value}):{});function g(s){let f=s;if(typeof s=="string"){if(T.includes(s))return s;if(U.includes(C(s))?f=B(s,!1):W.includes(C(s))&&(f=j(()=>te(()=>Promise.resolve().then(()=>Be),void 0,import.meta.url).then(_=>{const y=_[C(s)];return y?y():void 0}))),typeof f=="string")return f}if(!f)return f;const m=f;return"__asyncLoader"in m?m:"setup"in m?j(()=>Promise.resolve(m)):m}function v(s,f){if(!s)return;const m=Array.from(new Set(b(s,f))),h={};for(const[_,y]of m)if(!h[_]){if(typeof y=="object"&&n.some(k=>Object.hasOwnProperty.call(y,k))){h[_]=y;continue}h[_]=g(y)}return h}function b(s,f){const m=s.tag;if(s.type==="text"||m==="binding"||s.type==="comment")return[];const h=D(s,f.tags),_=[];s.type!=="root"&&!T.includes(h)&&_.push([m,h]);for(const y of s.children||[])_.push(...b(y,f));return _}function D(s,f){const m=s.tag;return!m||typeof s.props?.__ignoreMap<"u"?m:f[m]||f[C(m)]||f[I(s.tag)]||m}return(s,f)=>a.value?J(s.$slots,"empty",{key:1,body:r.value,data:p.value,dataContentId:x(o)?e.value.id:void 0}):(A(),$(Re,{key:0,body:r.value,data:p.value,class:ee(t.class),tag:t.tag,prose:t.prose,unwrap:t.unwrap,components:d.value,"data-content-id":x(o)?e.value.id:void 0},null,8,["body","data","class","tag","prose","unwrap","components","data-content-id"]))}},$e=Object.assign(He,{__name:"ContentRenderer"}),Ee={__name:"[...slug]",async setup(e){let n,t;const o=ne(),{data:r}=([n,t]=re(()=>le(`page-${o.path}`,()=>pe("content").path(o.path).first())),n=await n,t(),n);if(!r.value)throw oe({fatal:!0,statusCode:404,statusMessage:"Page not found"});return(a,p)=>{const i=$e;return x(r)?(A(),$(i,{key:0,prose:!0,value:x(r),class:"prose p-4 md:col-span-2 max-w-4xl"},null,8,["value"])):se("",!0)}}};export{Ee as default};
